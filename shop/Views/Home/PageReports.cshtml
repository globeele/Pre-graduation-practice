@{
    ViewBag.Title = "Отчеты по системе";
}




    <div class="jumbotron">
        <h1>Отчеты по системе</h1>

        <div class="row">


            <div class="col-md-4">
                <label>Структура реализованных заявок за период</label><br />
                <i>(группировка по ...)</i><br /><br />
                <form method="post">
                    с <input type="text" name="dat1" value="" /><br />
                    <br />
                    по <input type="text" name="dat2" value="" /><br />
                    <br />
                    <input class="btn btn-primary btn-lg" type="submit" name="report1" value="Показать &raquo;" />
                </form>
            </div>


            <div class="col-md-4">
                <label>Выручка по месяцам указанного года</label><br />
                <i>(группировка по каждому месяцу)</i><br /><br />
                <form method="post">
                    <input type="text" name="year" value="" /><br />
                    <br />
                    <input class="btn btn-primary btn-lg" type="submit" name="report2" value="Показать &raquo;" />
                </form>
            </div>

            <div class="col-md-4">
                <label>Объемы реализации по категориям зявок за период</label><br />
                <i>(группировка по каждой категории заявок)</i><br /><br />
                <form method="post">
                    с <input type="text" name="dat1" value="" /><br />
                    <br />
                    по <input type="text" name="dat2" value="" /><br />
                    <br />

                    <input class="btn btn-primary btn-lg" type="submit" name="report3" value="Показать &raquo;" />
                </form>
            </div>

        </div>


        <br />
        <br />

        <div class="row">

            <div class="col-md-4">
                <label>Сводная информация по исполнению заявок</label><br />
                <i>(группировка по статусу заявок)</i><br /><br />
                <form method="post">
                    с <input type="text" name="dat1" value="" /><br />
                    <br />
                    по <input type="text" name="dat2" value="" /><br />
                    <br />

                    <input class="btn btn-primary btn-lg" type="submit" name="report4" value="Показать &raquo;" />
                </form>
            </div>
            <div class="col-md-4">
                <label>Сводка заявок по клиентам за период</label><br />
                <i>(группировка по каждому клиенту)</i><br /><br />
                <form method="post">
                    с <input type="text" name="dat1" value="" /><br />
                    <br />
                    по <input type="text" name="dat2" value="" /><br />
                    <br />

                    <input class="btn btn-primary btn-lg" type="submit" name="report5" value="Показать &raquo;" />
                </form>
            </div>
            <div class="col-md-4">
                <label>Сводка по ОС</label><br /><br />
                <form method="post">

                    <input class="btn btn-primary btn-lg" type="submit" name="report6" value="Показать &raquo;" />
                </form>
            </div>
        </div>


        <br />
        <br />


        @switch (ViewBag.Rep)
        {
            case 1:
                {
                    <center>
                        <h1>ОТЧЕТ</h1>
                        <b>
                            Структура реализованных заявок (с группировкой по ...)
                        </b>
                        <br />
                        <i>
                            с @ViewBag.dat1 по @ViewBag.dat2
                        </i>
                        <br />
                        <br />
                    </center>

                    <table border="1" cellpadding="8" cellspacing="0">
                        <tr>
                            <th>Наименование техики</th>
                            <th>Количество проданных единиц</th>
                            <th>Всего, бел.руб.</th>
                            <th>НДС, бел.руб.</th>
                            <th>Итого c НДС, бел.руб.</th>
                        </tr>
                        @foreach (var item in ViewBag.query)
                        {
                            <tr>
                                <td>@item.Key</td>
                                <td>@item.Amount</td>
                                <td>@Math.Round(item.Sum, 2)</td>
                                <td>@Math.Round(item.NDS, 2)</td>
                                <td>@Math.Round(item.Itogo, 2)</td>
                            </tr>
                        }
                    </table>
                }
                break;

            case 2:
                {
                    <center>
                        <h1>ОТЧЕТ</h1>
                        <b>
                            Выручка по месяцам @ViewBag.year года
                        </b>
                        <br />
                        <i>
                            c группировкой по каждому месяцу
                        </i>

                        <br />
                        <br />
                    </center>

                    <table border="1" cellpadding="8" cellspacing="0">
                        <tr>
                            <th>Месяц</th>
                            <th>Количество проданных единиц</th>
                            <th>Всего, бел.руб.</th>
                            <th>НДС, бел.руб.</th>
                            <th>Итого c НДС, бел.руб.</th>
                        </tr>
                        @foreach (var item in ViewBag.query)
                        {
                            <tr>
                                <td>@item.Key</td>
                                <td>@item.Amount</td>
                                <td>@Math.Round(item.Sum, 2)</td>
                                <td>@Math.Round(item.NDS, 2)</td>
                                <td>@Math.Round(item.Itogo, 2)</td>
                            </tr>
                        }
                    </table>
                }
                break;



            case 3:
                {
                    <center>
                        <h1>ОТЧЕТ</h1>
                        <b>
                            Объемы продаж по категориям c группировкой по каждой категории
                        </b>
                        <br />
                        <i>
                            с @ViewBag.dat1 по @ViewBag.dat2
                        </i>
                        <br />
                        <br />
                    </center>

                    <table border="1" cellpadding="8" cellspacing="0">
                        <tr>
                            <th>Категория техники</th>
                            <th>Количество проданных единиц</th>
                            <th>Всего, бел.руб.</th>
                            <th>НДС, бел.руб.</th>
                            <th>Итого c НДС, бел.руб.</th>
                        </tr>
                        @foreach (var item in ViewBag.query)
                        {
                            <tr>
                                <td>@item.Key</td>
                                <td>@item.Amount</td>
                                <td>@Math.Round(item.Sum, 2)</td>
                                <td>@Math.Round(item.NDS, 2)</td>
                                <td>@Math.Round(item.Itogo, 2)</td>
                            </tr>
                        }
                    </table>
                }
                break;

            case 4:
                {
                    <center>
                        <h1>ОТЧЕТ</h1>
                        <b>
                            Сводная информация по исполнению заказов с группировкой по статусу заказа
                        </b>
                        <br />
                        <i>
                            с @ViewBag.dat1 по @ViewBag.dat2
                        </i>
                        <br />
                        <br />
                    </center>

                    <table border="1" cellpadding="8" cellspacing="0">
                        <tr>
                            <th>Статус заказа</th>
                            <th>Количество заказов</th>
                            <th>Количество единиц</th>

                            <th>Всего, бел.руб.</th>
                            <th>НДС, бел.руб.</th>
                            <th>Итого c НДС, бел.руб.</th>
                        </tr>

                        @foreach (var item in ViewBag.query)
                        {
                            <tr>
                                <td>@item.Key</td>
                                <td>@item.AmountZ</td>
                                <td>@Math.Round(item.AmountE, 2)</td>
                                <td>@Math.Round(item.Sum, 2)</td>
                                <td>@Math.Round(item.NDS, 2)</td>
                                <td>@Math.Round(item.Itogo, 2)</td>
                            </tr>
                        }
                    </table>
                }
                break;


            case 5:
                {
                    <center>
                        <h1>ОТЧЕТ</h1>
                        <b>
                            Сводка по покупателям
                        </b>
                        <br />
                        <i>
                            с @ViewBag.dat1 по @ViewBag.dat2
                        </i>
                        <br />
                        <br />
                    </center>

                    <table border="1" cellpadding="8" cellspacing="0">
                        <tr>
                            <th>Клиент, адрес</th>
                            <th>Количество заказов</th>
                            <th>Количество единиц</th>

                            <th>Всего, бел.руб.</th>
                            <th>НДС, бел.руб.</th>
                            <th>Итого c НДС, бел.руб.</th>
                        </tr>

                        @foreach (var item in ViewBag.query)
                        {
                            <tr>
                                <td>@item.Key</td>
                                <td>@item.AmountZ</td>
                                <td>@Math.Round(item.AmountE, 2)</td>
                                <td>@Math.Round(item.Sum, 2)</td>
                                <td>@Math.Round(item.NDS, 2)</td>
                                <td>@Math.Round(item.Itogo, 2)</td>
                            </tr>
                        }
                    </table>
                }
                break;


            case 6:
                {
                    <center>
                        <h1>ОТЧЕТ</h1>
                        <b>
                            Сводка по брендам
                        </b>
                        <br />
                        <br />
                    </center>

                    <table border="1" cellpadding="8" cellspacing="0">
                        <tr>
                            <th>Бренд</th>
                            <th>Количество единиц техники</th>
                            <th>Первый выпуск</th>
                            <th>Последний выпуск</th>
                        </tr>

                        @foreach (var item in ViewBag.query)
                        {
                            <tr>
                                <td>@item.Key</td>
                                <td>@item.Amount</td>
                                <td>@item.y1</td>
                                <td>@item.y2</td>
                            </tr>
                        }
                    </table>
                }
                break;

        }





    </div>